<!DOCTYPE html>
<html>
<head>
<link rel="shortcut icon" href="https://xzzz2020.github.io/favicon.ico" type="image/x-icon" /><meta name="viewport"content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/><meta name="apple-mobile-web-app-capable"content="yes"/><meta name="apple-mobile-web-app-status-bar-style"content="black"/><meta name="format-detection"content="telephone=no"/><meta name="renderer"content="webkit"><meta name="description"content="æ¸©æ•…è€ŒçŸ¥æ–°"><meta charset="UTF-8"><title>ã€æ€»ç»“ã€‘çº¿ç¨‹æ±  | xzzz2020</title>
<link href="https://xzzz2020.github.io/styles/main.css" type="text/css" rel="stylesheet" /><link href="https://at.alicdn.com/t/font_1621793_zatzzgvf30g.css" type="text/css" rel="stylesheet" /><link rel="stylesheet" href="https://xzzz2020.github.io/media/css/katex.css"><script async src="https://cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.min.js"></script><script src="https://xzzz2020.github.io/media/js/magnify.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
<script type="text/javascript">function btn_toggle(){document.getElementById("hn").classList.contains("no-js")?document.getElementById("hn").classList.remove("no-js"):document.getElementById("hn").classList.add("no-js")}</script>

<link rel="canonical" href="https://xzzz2020.github.io/post/oJRLv7myX/" />
</head>
<body>
<div class="progress"></div><style>.progress{background:linear-gradient(to right,#87ceeb var(--scroll),transparent 0);background-repeat:no-repeat;position:fixed;width:100%;height:4px;z-index:1}</style><div class="darkmode-background"></div><div class="darkmode-layer"></div>
<noscript><p class="warn" >æœ¬é¡µé¢éœ€è¦æµè§ˆå™¨æ”¯æŒï¼ˆå¯ç”¨ï¼‰JavaScript</p></noscript><div class="header"><div class="logo_title"><div class="title animated fadeInDown"><a href="https://xzzz2020.github.io"><img alt="logo" style="display:inline-block;" src="https://xzzz2020.github.io/images/avatar.png"/></a><h1 title="xzzz2020" class="weaklink"><a  href="/">xzzz2020</a></h1>

<div class="navbar weaklink">
<div class="normal_nav">
<div class="bitcron_nav_container"><div class="bitcron_nav"><div class="bitcron_nav"><div style="display:flex;justify-content:center;"><nav class="mixed_site_nav_wrap site_nav_wrap"><ul class="mixed_site_nav site_nav sm sm-base">	<li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/" class="selected active current nav__item" >é¦–é¡µ</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/archives" class="selected active current nav__item" >å½’æ¡£</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tags" class="selected active current nav__item" >æ ‡ç­¾</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/about" class="selected active current nav__item" >å…³äº</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/Friendship_chain" class="selected active current nav__item" >å‹é“¾</a></li></ul></nav>
<div style="float:right;margin-top:1em"><form id="gridea-search-form" data-update="1578893743252" action="/search/index.html"><input class="search-input" autocomplete="off" spellcheck="false" name="q" placeholder="Search..."></form></div><div style="margin-left:0.5em;margin-top:1.2em"><input id="switch_default" onclick="mobileBtn()" type="checkbox" class="switch_default"><label for="switch_default" class="toggleBtn"></label></div></div>
<div class="clear clear_nav_inline_end"></div></div></div><div class="clear clear_nav_end"></div></div></div><div class="hamberger" href="javascript:void(0)" onclick="btn_toggle();"><i class="iconfont icon-category"></i></div></div></div></div>
<div id="hn" class="no-js hidden_nav animated fadeInDown"><div class="bitcron_nav_container"><div class="bitcron_nav"><nav class="mixed_site_nav_wrap site_nav_wrap"><ul class="mixed_site_nav site_nav sm sm-base">	<li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/" class="selected active current nav__item" >é¦–é¡µ</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/archives" class="selected active current nav__item" >å½’æ¡£</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/tags" class="selected active current nav__item" >æ ‡ç­¾</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/about" class="selected active current nav__item" >å…³äº</a></li><li><a id="d2ef19af68cc211e98f8a0242ac110003" href="/post/Friendship_chain" class="selected active current nav__item" >å‹é“¾</a></li></ul><div class="clear clear_nav_inline_end"></div></nav></div><div class="clear clear_nav_end"></div></div>
<div style="display:flex;justify-content:center;inline-block;text-align:center;margin-top:7%"><div><form id="gridea-search-form" data-update="1599740351189" action="/search/index.html"><input class="search-input" autocomplete="off" spellcheck="false" name="q"  placeholder="Search..." /></form></div><div style="margin-left:0.5em"><input id="switch_default_h" onclick="mobileBtn()" type="checkbox" class="switch_default"><label for="switch_default" class="toggleBtn"></label></div></div>
</div></div>
<script>function enableDarkmode(){document.body.classList.add("darkmode"),document.getElementById("switch_default").checked=1,document.getElementById("switch_default_h").checked=1}function removeDarkmode(){document.body.classList.remove("darkmode"),document.getElementById("switch_default").checked=0,document.getElementById("switch_default_h").checked=0}function getCookie(a){var b,c=new RegExp("(^| )"+a+"=([^;]*)(;|$)");return(b=document.cookie.match(c))?unescape(b[2]):null}cookie=getCookie("darkmode"),"enable"==cookie&&enableDarkmode(),window.matchMedia("(prefers-color-scheme: dark)").matches&&"disable"!==cookie&&(enableDarkmode(),document.cookie="darkmode=enable; path=/");var mobileBtn=function(){1==document.getElementById("switch_default").checked?(enableDarkmode(),document.cookie="darkmode=enable; path=/"):(removeDarkmode(),document.cookie="darkmode=disable; path=/")};</script>

<div class="main"><div class="main-inner"><div class="content">
<article class="post">
<h2 class="post_title sm_margin"><a>ã€æ€»ç»“ã€‘çº¿ç¨‹æ± </a></h2>
<script>function lan(){if(document.getElementById("lan").innerText=="ç¹"){var s=document.getElementById("tongwenlet_cn");if(s!=null){document.body.removeChild(s)}var s=document.createElement("script");s.language="javascript";s.type="text/javascript";s.src="https://cdn.jsdelivr.net/gh/qyxtim/Static@1.1/bookmarklet_tw.js";s.id="tongwenlet_cn";document.body.appendChild(s);document.getElementById("lan").innerHTML="ç®€"}else{if(document.getElementById("lan").innerText=="ç°¡"){var s=document.getElementById("tongwenlet_cn");if(s!=null){document.body.removeChild(s)}var s=document.createElement("script");s.language="javascript";s.type="text/javascript";s.src="https://cdn.jsdelivr.net/gh/qyxtim/Static@1.1/bookmarklet_cn.js";s.id="tongwenlet_cn";document.body.appendChild(s);document.getElementById("lan").innerHTML="ç¹"}}};</script>
<section class="post_details"><i class="iconfont icon-calendar"></i><span style="margin-right:15px"> 2020-07-12</span><i class="iconfont icon-browse"></i><span style="margin-right:15px"> <span id="busuanzi_value_page_pv"></span> Views</span><i class="iconfont icon-category"></i><span class="weaklink" style="margin-right:15px">	<a href="https://xzzz2020.github.io/tag/Java_concurrency/" class="tag">Javaå¹¶å‘</a> | 	<a href="https://xzzz2020.github.io/tag/Interview_summary/" class="tag">é¢è¯•æ€»ç»“</a></span><i class="iconfont icon-caret-down"></i><span style="margin-right:15px">2427å­—</span><i class="iconfont icon-naozhong"></i><span style="margin-right:15px">9 min read</span><a id="lan" href="javascript:void(0);"onclick="lan();"title="è°ƒæ•´ç®€ç¹ä½“" style="margin-right:15px;">ç¹</a>
</section>

<img class="featureImg" alt="featureimg" src="https://img-1302474103.cos.ap-nanjing.myqcloud.com/img/photo-1594229377634-9499f45f99a9.webp" referrerpolicy="no-referrer">

<div style="display:flex">
<div class="md_block" id="md_block">
<div class="round-shape-one"></div>
<blockquote>
<p>è¯¥æ–‡ç« ä¸ºé¢è¯•ç²¾åç‰ˆï¼Œå¦‚æœæ˜¯åˆå­¦è€…ï¼Œå»ºè®®å­¦ä¹ ä¸“æ ï¼š<a href="https://blog.csdn.net/qq_43040688/category_9910156.html">Javaå¹¶å‘ä¸“æ </a></p>
</blockquote>
<blockquote>
<p>Javaå¹¶å‘éœ€è¦ç»“åˆJVMä»¥åŠæ“ä½œç³»ç»Ÿçš„ç›¸å…³çŸ¥è¯†ï¼Œå»ºè®®å…ˆå­¦ä¹ è¿™ä¸¤ä¸ªéƒ¨åˆ†ï¼š<a href="https://blog.csdn.net/qq_43040688/category_9819683.html">JVMä¸“æ </a> å’Œ <a href="https://xzzz2020.gitee.io/tag/operating_system/">æ“ä½œç³»ç»Ÿä¸“æ </a></p>
</blockquote>
<p><ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E4%B8%80-threadpoolexecutor%E5%8F%82%E6%95%B0%E5%90%AB%E4%B9%89">ä¸€ã€ThreadPoolExecutorå‚æ•°å«ä¹‰</a>
<ul>
<li><a href="#1-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E7%BA%BF%E7%A8%8B">1. ä»€ä¹ˆæ—¶å€™åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Ÿ</a></li>
<li><a href="#2-%E5%A6%82%E4%BD%95%E5%85%B3%E9%97%AD%E7%BA%BF%E7%A8%8B%E6%B1%A0">2. å¦‚ä½•å…³é—­çº¿ç¨‹æ± ï¼Ÿ</a></li>
</ul>
</li>
<li><a href="#%E4%BA%8C-%E6%8B%92%E7%BB%9D%E7%AD%96%E7%95%A5">äºŒã€æ‹’ç»ç­–ç•¥</a></li>
<li><a href="#%E4%B8%89-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E7%8A%B6%E6%80%81">ä¸‰ã€çº¿ç¨‹æ± çš„çŠ¶æ€</a></li>
<li><a href="#%E5%9B%9B-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%88%86%E7%B1%BB">å››ã€çº¿ç¨‹æ± åˆ†ç±»</a>
<ul>
<li><a href="#newcachedthreadpool">newCachedThreadPool</a></li>
<li><a href="#newfixedthreadpool">newFixedThreadPool</a></li>
<li><a href="#newsinglethreadexecutor">newSingleThreadExecutor</a></li>
<li><a href="#newscheduledthreadpool">newScheduledThreadPool</a></li>
<li><a href="#newworkstealingpool">newWorkStealingPool</a></li>
</ul>
</li>
<li><a href="#%E4%BA%94-%E4%BD%BF%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E5%A5%BD%E5%A4%84">äº”ã€ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„</a></li>
</ul>
</li>
</ul>
</p>
<h2 id="ä¸€-threadpoolexecutorå‚æ•°å«ä¹‰">ä¸€ã€ThreadPoolExecutorå‚æ•°å«ä¹‰</h2>
<pre><code class="language-java">public ThreadPoolExecutor(int corePoolSize,
                              int maximumPoolSize,
                              long keepAliveTime,
                              TimeUnit unit,
                              BlockingQueue&lt;Runnable&gt; workQueue,
                              ThreadFactory threadFactory,
                              RejectedExecutionHandler handler)
</code></pre>
<ul>
<li><strong>corePoolSize</strong>ï¼šçº¿ç¨‹æ± å§‹ç»ˆçº¿ç¨‹æ•°ï¼Œå³ä½¿æœ‰äº›æ˜¯ç©ºé—²çš„ã€‚è®¾ç½®<code>allowCoreThreadTimeOut</code>å‚æ•°ä¸ºtrueï¼Œæ‰ä¼šè¿›è¡Œå›æ”¶ã€‚</li>
<li><strong>maximumPoolSize</strong>ï¼šçº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°ï¼Œè¡¨ç¤ºåœ¨çº¿ç¨‹æ± ä¸­æœ€å¤šèƒ½åˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹ã€‚å¦‚æœå½“çº¿ç¨‹æ± ä¸­çš„æ•°é‡åˆ°è¾¾è¿™ä¸ªæ•°å­—æ—¶ï¼Œæ–°æ¥çš„ä»»åŠ¡ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</li>
<li><strong>keepAliveTime</strong>ï¼šè¡¨ç¤ºçº¿ç¨‹æ²¡æœ‰ä»»åŠ¡æ‰§è¡Œæ—¶æœ€å¤šèƒ½ä¿æŒå¤šå°‘æ—¶é—´ä¼šå›æ”¶ï¼Œç„¶åçº¿ç¨‹æ± çš„æ•°ç›®ç»´æŒåœ¨corePoolSizeã€‚</li>
<li><strong>unit</strong>ï¼šå‚æ•°keepAliveTimeçš„æ—¶é—´å•ä½</li>
<li><strong>workQueue</strong>ï¼šä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ï¼Œæ‰€æœ‰çš„ä»»åŠ¡éƒ½ä¼šå…ˆæ”¾åœ¨è¿™é‡Œï¼ŒåŠ¡ï¼›å¦‚æœå¯¹å½“å‰å¯¹çº¿ç¨‹çš„éœ€æ±‚è¶…è¿‡äº†corePoolSizeå¤§å°ï¼Œä¼šç”¨æ¥å­˜å‚¨ç­‰å¾…æ‰§è¡Œçš„ä»»ã€‚</li>
<li><strong>threadFactory</strong>ï¼šçº¿ç¨‹å·¥å‚ï¼Œä¸»è¦ç”¨æ¥åˆ›å»ºçº¿ç¨‹ï¼Œæ¯”å¦‚æŒ‡å®šçº¿ç¨‹çš„åå­—ã€‚</li>
<li><strong>handler</strong>ï¼šå¦‚æœçº¿ç¨‹æ± å·²æ»¡ï¼Œæ–°çš„ä»»åŠ¡å¤„ç†æ–¹å¼ã€‚</li>
</ul>
<p><strong>æ³¨æ„ä¸€ç‚¹</strong>ï¼š<mark>åˆå§‹åŒ–çº¿ç¨‹æ± æ—¶ï¼Œçº¿ç¨‹æ•°ä¸º0</mark></p>
<h3 id="1-ä»€ä¹ˆæ—¶å€™åˆ›å»ºæ–°çš„çº¿ç¨‹">1. ä»€ä¹ˆæ—¶å€™åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Ÿ</h3>
<ul>
<li>çº¿ç¨‹åˆå§‹åŒ–æ—¶çº¿ç¨‹æ•°ä¸º0</li>
<li>å½“å‰çº¿ç¨‹æ•°å°äºcorePoolSizeæ—¶ï¼Œæäº¤ä»»åŠ¡ä¼šç›´æ¥åˆ›å»ºæ–°çš„çº¿ç¨‹</li>
<li>å½“å‰çº¿ç¨‹æ•°å¤§äºç­‰äºä¸ºcorePoolSizeæ—¶ï¼Œæäº¤ä»»åŠ¡ä¼šæ”¾åˆ°é˜»å¡é˜Ÿåˆ—ä¸­ï¼Œå½“é˜»å¡é˜Ÿåˆ—æ»¡æ—¶ä¼šåˆ›å»ºçº¿ç¨‹</li>
</ul>
<h3 id="2-å¦‚ä½•å…³é—­çº¿ç¨‹æ± ">2. å¦‚ä½•å…³é—­çº¿ç¨‹æ± ï¼Ÿ</h3>
<p><strong>shutdownï¼ˆé«˜å®‰å…¨ä½å“åº”ï¼‰</strong></p>
<ul>
<li>
<p>æœ¬è´¨ä¸Šæ‰§è¡Œçš„æ˜¯<code>interrupt</code>æ–¹æ³•</p>
</li>
<li>
<p>é˜»æ­¢æ–°æ¥çš„ä»»åŠ¡æäº¤ï¼Œä¼šå°†çº¿ç¨‹æ± çš„çŠ¶æ€æ”¹æˆSHUTDOWNï¼Œå½“å†å°†æ‰§è¡Œexecuteæäº¤ä»»åŠ¡æ—¶ï¼Œå¦‚æœæµ‹è¯•åˆ°çŠ¶æ€ä¸ä¸ºRUNNINGï¼Œåˆ™æ‰§è¡Œæ‹’ç»ç­–ç•¥ï¼Œä»è€Œè¾¾åˆ°é˜»æ­¢æ–°ä»»åŠ¡æäº¤çš„ç›®çš„ã€‚</p>
</li>
<li>
<p>å¯¹å·²ç»æäº¤äº†çš„ä»»åŠ¡ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ï¼Œå½“å·²ç»æäº¤çš„ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œå®ƒä¼šå°†é‚£äº›é—²ç½®çš„çº¿ç¨‹è¿›è¡Œä¸­æ–­ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åªä¼šæ‰“æ–­ç©ºé—²çº¿ç¨‹ï¼Œå¦‚æœå½“å‰è¿˜æœ‰ä»»åŠ¡é˜Ÿåˆ—è¿˜æœ‰ä»»åŠ¡æœªæ‰§è¡Œï¼Œçº¿ç¨‹å°†ç»§ç»­æŠŠä»»åŠ¡æ‰§è¡Œå®Œã€‚</p>
</li>
</ul>
<p><strong>shutdownNowï¼ˆä½å®‰å…¨é«˜å“åº”ï¼‰</strong></p>
<ul>
<li>
<p>é˜»æ­¢æ–°æ¥çš„ä»»åŠ¡æäº¤ï¼Œå°†çº¿ç¨‹æ± çš„çŠ¶æ€æ”¹æˆSTOPï¼Œå½“å†å°†æ‰§è¡Œexecuteæäº¤ä»»åŠ¡æ—¶ï¼Œå¦‚æœæµ‹è¯•åˆ°çŠ¶æ€ä¸ä¸ºRUNNINGï¼Œåˆ™æŠ›å‡ºrejectedExecutionï¼Œä»è€Œè¾¾åˆ°é˜»æ­¢æ–°ä»»åŠ¡æäº¤çš„ç›®çš„.</p>
</li>
<li>
<p>ä¼šä¸­æ–­ç©ºé—²è¿›ç¨‹ï¼ŒåŒæ—¶ä¹Ÿä¼šä¸­æ–­å½“å‰æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Œå³workersä¸­çš„çº¿ç¨‹ã€‚</p>
</li>
<li>
<p>å¦å¤–å®ƒè¿˜å°†workQueueä¸­çš„ä»»åŠ¡ç»™ç§»é™¤ï¼Œå¹¶å°†è¿™äº›ä»»åŠ¡æ·»åŠ åˆ°åˆ—è¡¨ä¸­è¿›è¡Œè¿”å›ã€‚</p>
</li>
<li>
<p>å¦‚é‡å·²ç»æ¿€æ´»çš„ä»»åŠ¡ï¼Œå¹¶ä¸”å¤„äºé˜»å¡çŠ¶æ€æ—¶ï¼ŒshutdownNow()ä¼šæ‰§è¡Œ1æ¬¡ä¸­æ–­é˜»å¡çš„æ“ä½œï¼Œæ­¤æ—¶å¯¹åº”çš„çº¿ç¨‹æŠ¥InterruptedExceptionï¼Œå¦‚æœåç»­è¿˜è¦ç­‰å¾…æŸä¸ªèµ„æºï¼Œåˆ™æŒ‰æ­£å¸¸é€»è¾‘ç­‰å¾…æŸä¸ªèµ„æºçš„åˆ°è¾¾ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªçº¿ç¨‹æ­£åœ¨sleepçŠ¶æ€ä¸­ï¼Œæ­¤æ—¶æ‰§è¡ŒshutdownNow()ï¼Œå®ƒå‘è¯¥çº¿ç¨‹å‘èµ·interrupt()è¯·æ±‚ï¼Œè€Œsleep()æ–¹æ³•é‡åˆ°æœ‰interrupt()è¯·æ±‚æ—¶ï¼Œä¼šæŠ›å‡ºInterruptedException()ï¼Œå¹¶ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚åœ¨è¿™é‡Œè¦æé†’æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ¿€æ´»çš„ä»»åŠ¡ä¸­ï¼Œå¦‚æœæœ‰å¤šä¸ªsleep(),è¯¥æ–¹æ³•åªä¼šä¸­æ–­ç¬¬ä¸€ä¸ªsleep()ï¼Œè€Œåé¢çš„ä»ç„¶æŒ‰ç…§æ­£å¸¸çš„æ‰§è¡Œé€»è¾‘è¿›è¡Œã€‚</p>
</li>
</ul>
<p>é«˜å®‰å…¨ä½å“åº”ä½“ç°åœ¨shutdownç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆå†å…³é—­ï¼Œå¯ä»¥ä¿è¯ä»»åŠ¡ä¸€å®šè¢«æ‰§è¡Œï¼Œä½†æ˜¯å…³é—­çº¿ç¨‹æ± éœ€è¦ç­‰å¾…è¾ƒé•¿çš„æ—¶é—´</p>
<p>ä½å®‰å…¨é«˜å“åº”ä½“ç°åœ¨shutdownNowä¼šå…³é—­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ï¼Œä»»åŠ¡å¯èƒ½å¹¶æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œä¹Ÿä¸ä¼šå›é€€åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå°†ä¼šæ¶ˆå¤±ï¼Œä½†æ˜¯å…³é—­çº¿ç¨‹æ± ä¸éœ€è¦ç­‰å¾…è¾ƒé•¿çš„æ—¶é—´</p>
<p><strong>å¦‚æœä¸€ä¸ªä»»åŠ¡æ‰§è¡Œæ—¶é—´å¾ˆé•¿ï¼Œå¯¼è‡´çº¿ç¨‹æ± é•¿æ—¶é—´å…³é—­ä¸äº†ï¼Œå¯ä»¥åœ¨åˆ›å»ºçº¿ç¨‹çš„æ—¶å€™å°†å…¶è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œæ­¤æ—¶è¢«å®ˆæŠ¤çš„çº¿ç¨‹æ˜¯ä¸»çº¿ç¨‹ï¼Œåªè¦ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæˆï¼Œçº¿ç¨‹æ± å°±ä¼šå¼ºåˆ¶å…³é—­ï¼Œå¯ä»¥é…åˆawaitTerminationä½¿ç”¨</strong>ï¼š</p>
<pre><code class="language-java">ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor(1,2,
        30, TimeUnit.SECONDS,new ArrayBlockingQueue&lt;&gt;(5), r -&gt; {
    Thread t = new Thread(r);
    t.setDaemon(true);
    return t;
},new ThreadPoolExecutor.AbortPolicy());

public static void main(String[] args) throws InterruptedException {
    ThreadPoolExecutor threadPoolExecutor = bulidThreadPoolExecutor();
    threadPoolExecutor.shutdown();
    threadPoolExecutor.awaitTermination(5,TimeUnit.SECONDS);
    System.out.println(&quot;å¼ºåˆ¶å…³é—­&quot;);
}
</code></pre>
<h2 id="äºŒ-æ‹’ç»ç­–ç•¥">äºŒã€æ‹’ç»ç­–ç•¥</h2>
<p>çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹å·²ç»ç”¨å®Œäº†ï¼Œæ— æ³•ç»§ç»­ä¸ºæ–°ä»»åŠ¡æœåŠ¡ï¼ŒåŒæ—¶ï¼Œç­‰å¾…é˜Ÿåˆ—ä¹Ÿå·²ç»æ’æ»¡äº†ï¼Œå†ä¹Ÿ<br>
å¡ä¸ä¸‹æ–°ä»»åŠ¡äº†ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦æ‹’ç»ç­–ç•¥æœºåˆ¶åˆç†çš„å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚<br>
<strong>JDK å†…ç½®çš„æ‹’ç»ç­–ç•¥å¦‚ä¸‹</strong>ï¼š</p>
<ol>
<li><strong>AbortPolicy</strong> ï¼š ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œé˜»æ­¢ç³»ç»Ÿæ­£å¸¸è¿è¡Œã€‚</li>
<li><strong>CallerRunsPolicy</strong> ï¼š å¯¼è‡´è¯¥æ–¹æ³•ç›´æ¥åœ¨è°ƒç”¨è€…çš„ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œè€Œä¸æ˜¯åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä¸»çº¿ç¨‹åœ¨è¯¥ä»»åŠ¡æ‰§è¡Œç»“æŸä¹‹å‰ä¸èƒ½æäº¤ä»»ä½•ä»»åŠ¡ã€‚ä»è€Œæœ‰æ•ˆçš„é˜»æ­¢äº†ä»»åŠ¡çš„æäº¤ã€‚</li>
<li><strong>DiscardOldestPolicy</strong> ï¼š ä¸¢å¼ƒæœ€è€çš„ä¸€ä¸ªè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯å³å°†è¢«æ‰§è¡Œçš„ä¸€ä¸ªä»»åŠ¡ï¼Œä¼šç›´æ¥å‡ºé˜Ÿï¼Œå¹¶å°è¯•å†<br>
æ¬¡æäº¤å½“å‰ä»»åŠ¡ã€‚</li>
<li><strong>DiscardPolicy</strong> ï¼šé»˜è®¤æƒ…å†µä¸‹å®ƒå°†ä¸¢å¼ƒè¢«æ‹’ç»çš„ä»»åŠ¡</li>
</ol>
<p>ä»¥ä¸Šå†…ç½®æ‹’ç»ç­–ç•¥å‡å®ç°äº† RejectedExecutionHandler æ¥å£ï¼Œè‹¥ä»¥ä¸Šç­–ç•¥ä»æ— æ³•æ»¡è¶³å®é™…<br>
éœ€è¦ï¼Œå®Œå…¨å¯ä»¥è‡ªå·±æ‰©å±• RejectedExecutionHandler æ¥å£ã€‚</p>
<h2 id="ä¸‰-çº¿ç¨‹æ± çš„çŠ¶æ€">ä¸‰ã€çº¿ç¨‹æ± çš„çŠ¶æ€</h2>
<ul>
<li><strong>RUNNING</strong>ï¼šèƒ½å¤Ÿæ¥æ”¶æ–°ä»»åŠ¡ï¼Œä»¥åŠå¯¹å·²æ·»åŠ çš„ä»»åŠ¡è¿›è¡Œå¤„ç†ã€‚</li>
<li><strong>SHUTDOWN</strong>ï¼šä¸æ¥æ”¶æ–°ä»»åŠ¡ï¼Œä½†èƒ½å¤„ç†å·²æ·»åŠ çš„ä»»åŠ¡ã€‚</li>
<li><strong>STOP</strong>ï¼šç¨‹æ± å¤„åœ¨STOPçŠ¶æ€æ—¶ï¼Œä¸æ¥æ”¶æ–°ä»»åŠ¡ï¼Œä¸å¤„ç†å·²æ·»åŠ çš„ä»»åŠ¡ï¼Œå¹¶ä¸”ä¼šä¸­æ–­æ­£åœ¨å¤„ç†çš„ä»»åŠ¡ã€‚</li>
<li><strong>TIDYING</strong>ï¼šå½“æ‰€æœ‰çš„ä»»åŠ¡å·²ç»ˆæ­¢</li>
<li><strong>TERMINATED</strong>ï¼šçº¿ç¨‹æ± å½»åº•ç»ˆæ­¢ï¼Œå°±å˜æˆTERMINATEDçŠ¶æ€ã€‚</li>
</ul>
<h2 id="å››-çº¿ç¨‹æ± åˆ†ç±»">å››ã€çº¿ç¨‹æ± åˆ†ç±»</h2>
<p>Java é‡Œé¢çº¿ç¨‹æ± çš„é¡¶çº§æ¥å£æ˜¯ Executorï¼Œä½†æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šè®² Executor å¹¶ä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œè€Œ<br>
åªæ˜¯ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹çš„å·¥å…·ã€‚çœŸæ­£çš„çº¿ç¨‹æ± æ¥å£æ˜¯ ExecutorService</p>
<blockquote>
<p><strong>æ‘˜è‡ªé˜¿é‡Œå·´å·´å¼€å‘æ‰‹å†Œ</strong>:</p>
<p>ã€å¼ºåˆ¶ã€‘çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ Executors å»åˆ›å»ºï¼Œè€Œæ˜¯é€šè¿‡ ThreadPoolExecutor çš„æ–¹å¼ï¼Œè¿™æ · çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©ã€‚ è¯´æ˜ï¼šExecutors è¿”å›çš„çº¿ç¨‹æ± å¯¹è±¡çš„å¼Šç«¯å¦‚ä¸‹ï¼š</p>
<p>1ï¼‰FixedThreadPool å’Œ SingleThreadPool: å…è®¸çš„è¯·æ±‚é˜Ÿåˆ—é•¿åº¦ä¸º Integer.MAX_VALUEï¼Œå¯èƒ½ä¼šå †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</p>
<p>2ï¼‰CachedThreadPool å’Œ ScheduledThreadPool: å…è®¸çš„åˆ›å»ºçº¿ç¨‹æ•°é‡ä¸º Integer.MAX_VALUEï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çš„çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</p>
</blockquote>
<h3 id="newcachedthreadpool">newCachedThreadPool</h3>
<ul>
<li><strong>çº¿ç¨‹æ± çš„å‚æ•°</strong>ï¼šcoreSizeçº¿ç¨‹æ•°0ï¼Œæœ€å¤§çº¿ç¨‹æ•°æ— é™åˆ¶ï¼Œçº¿ç¨‹çš„å…è®¸ç©ºé—²æ—¶é—´æ˜¯60sï¼Œé˜»å¡é˜Ÿåˆ—æ˜¯SynchronousQueue</li>
<li>è¿™ä¸ªçº¿ç¨‹æ± é€‚ç”¨æƒ…å†µæ˜¯<code>çŸ­ä»»åŠ¡</code>æƒ…å†µã€‚</li>
<li>é‡‡ç”¨SynchronousQueueï¼Œæ¯å½“æäº¤ä¸€ä¸ªä»»åŠ¡ï¼Œéƒ½ä¼šè¶…è¿‡é˜»å¡é˜Ÿåˆ—çš„é•¿åº¦ï¼Œå¯¼è‡´åˆ›å»ºçº¿ç¨‹ï¼Œæ‰€ä»¥è¯´ï¼šæ¯å½“æäº¤ä¸€ä¸ªä»»åŠ¡ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå¯èƒ½é€ æˆOOMã€‚</li>
<li>å½“çº¿ç¨‹ç©ºé—²1åˆ†é’Ÿå°±ä¼šï¼Œé”€æ¯ï¼Œæ‰€ä»¥è¯¥çº¿ç¨‹æ± ä¼šé¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ï¼Œæœ€ç»ˆä¼šçº¿ç¨‹æ± ä¼šè‡ªå·±é”€æ¯</li>
</ul>
<h3 id="newfixedthreadpool">newFixedThreadPool</h3>
<ul>
<li>coreSizeå’Œæœ€å¤§çº¿ç¨‹æ•°éƒ½æ˜¯ç”¨æˆ·è¾“å…¥çš„ï¼Œé˜»å¡é˜Ÿåˆ—ç”¨çš„LinkedBlockingQueueï¼Œçº¿ç¨‹çš„å…è®¸ç©ºé—²æ—¶é—´æ˜¯0s</li>
<li>è¯¥çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ï¼Œä¸ä¼šå¢åŠ ï¼Œä¸ä¼šå‡å°‘ï¼Œçº¿ç¨‹æ± ä¸ä¼šè‡ªå·±é”€æ¯ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯åˆšå¼€å§‹å°±ä¼šç›´æ¥åˆ›å»ºcoreSizeçš„çº¿ç¨‹</li>
<li>é˜»å¡é˜Ÿåˆ—æ˜¯æ— é™å¤§çš„ï¼Œä¸ä¼šæ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚</li>
<li>å¯èƒ½ä¼šå †é›†æ— é™çš„è¯·æ±‚ï¼Œå¯¼è‡´OOM</li>
</ul>
<h3 id="newsinglethreadexecutor">newSingleThreadExecutor</h3>
<ul>
<li>ç›¸å½“äºçº¿ç¨‹æ•°ä¸º1çš„newFixedThreadPoolï¼Œç¼ºç‚¹å’ŒnewFixedThreadPoolä¸€æ ·</li>
</ul>
<p><strong>å’Œä¸€ä¸ªçº¿ç¨‹çš„åŒºåˆ«ï¼Ÿ</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">newSingleThreadExecutor</th>
<th style="text-align:center">Thread</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œä¸ä¼šè‡ªåŠ¨é”€æ¯ï¼Œå¯ä»¥å¤ç”¨</td>
<td style="text-align:center">ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œä¼šè‡ªåŠ¨é”€æ¯</td>
</tr>
<tr>
<td style="text-align:center">å¯ä»¥å°†ä»»åŠ¡å­˜å‚¨åœ¨é˜»å¡é˜Ÿåˆ—ä¸­ï¼Œé€ä¸ªæ‰§è¡Œ</td>
<td style="text-align:center">æ— æ³•å­˜å‚¨ä»»åŠ¡ï¼Œåªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡</td>
</tr>
</tbody>
</table>
<h3 id="newscheduledthreadpool">newScheduledThreadPool</h3>
<ul>
<li>å¯ä»¥åˆ›å»ºå®šæ—¶çš„ä»»åŠ¡ï¼Œä»¥å›ºå®šå‘¨æœŸæ‰§è¡Œæˆ–è€…å›ºå®šçš„å»¶è¿Ÿæ—¶é—´æ‰§è¡Œ</li>
<li><strong>å¦‚æœä»»åŠ¡æ—¶é—´è¶…è¿‡äº†å®šæ—¶æ—¶é•¿ï¼Œå°±æ— æ³•æŒ‰ç…§é¢„å®šçš„æ—¶é—´æ‰§è¡Œ</strong></li>
<li>è€ŒLinux<code>crontab</code>å®šæ—¶å¤„ç†å™¨<strong>ä¸ºäº†ç¡®ä¿æ—¶é—´çš„æ­£ç¡®æ€§ï¼Œä¼šé‡æ–°å¯ä¸€ä¸ªçº¿ç¨‹</strong></li>
</ul>
<h3 id="newworkstealingpool">newWorkStealingPool</h3>
<ul>
<li>é‡‡ç”¨çš„ForkJoinæ¡†æ¶ï¼Œå¯ä»¥å°†ä»»åŠ¡è¿›è¡Œåˆ†å‰²ï¼ŒåŒæ—¶çº¿ç¨‹ä¹‹é—´ä¼šäº’ç›¸å¸®åŠ©</li>
<li>é˜»å¡é˜Ÿåˆ—é‡‡ç”¨çš„LinkedBlockingDequeï¼Œå¯ä»¥è¿›è¡Œä»»åŠ¡çªƒå–</li>
</ul>
<h2 id="äº”-ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„">äº”ã€ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„</h2>
<ul>
<li><strong>çº¿ç¨‹é‡ç”¨</strong>ï¼šçº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯çš„å¼€é”€æ˜¯å·¨å¤§çš„ï¼Œè€Œé€šè¿‡çº¿ç¨‹æ± çš„é‡ç”¨å¤§å¤§å‡å°‘äº†è¿™äº›ä¸å¿…è¦çš„å¼€é”€ï¼Œå½“ç„¶æ—¢ç„¶å°‘äº†è¿™ä¹ˆå¤šæ¶ˆè´¹å†…å­˜çš„å¼€é”€ï¼Œå…¶çº¿ç¨‹æ‰§è¡Œé€Ÿåº¦ä¹Ÿæ˜¯çªé£çŒ›è¿›çš„æå‡ã€‚</li>
<li><strong>æ§åˆ¶çº¿ç¨‹æ± çš„å¹¶å‘æ•°</strong>ï¼šçº¿ç¨‹ä¸æ˜¯å¹¶å‘çš„è¶Šå¤šï¼Œæ€§èƒ½è¶Šé«˜ï¼Œåè€Œåœ¨çº¿ç¨‹å¹¶å‘å¤ªå¤šæ—¶ï¼Œçº¿ç¨‹çš„åˆ‡æ¢ä¼šæ¶ˆè€—ç³»ç»Ÿå¤§é‡çš„èµ„æºï¼Œå¯ä»¥é€šè¿‡çš„è®¾ç½®çº¿ç¨‹æ± æœ€å¤§å¹¶å‘çº¿ç¨‹æ•°ç›®ï¼Œç»´æŒç³»ç»Ÿé«˜æ€§èƒ½</li>
<li><strong>çº¿ç¨‹æ± å¯ä»¥å¯¹çº¿ç¨‹è¿›è¡Œç®¡ç†</strong>ï¼šè™½ç„¶çº¿ç¨‹æä¾›äº†çº¿ç¨‹ç»„æ“æ§çº¿ç¨‹ï¼Œä½†æ˜¯çº¿ç¨‹æ± æ‹¥æœ‰æ›´å¤šç®¡ç†çº¿ç¨‹çš„API</li>
<li><strong>å¯ä»¥å‚¨å­˜éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡</strong>ï¼šå½“ä»»åŠ¡æäº¤è¿‡å¤šæ—¶ï¼Œå¯ä»¥å°†ä»»åŠ¡å‚¨å­˜èµ·æ¥ï¼Œç­‰å¾…çº¿ç¨‹å¤„ç†</li>
</ul>

<span id="footnote"></span>
<div id = "warn"></div>
</div>
<div class="toc-container"><ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E4%B8%80-threadpoolexecutor%E5%8F%82%E6%95%B0%E5%90%AB%E4%B9%89">ä¸€ã€ThreadPoolExecutorå‚æ•°å«ä¹‰</a>
<ul>
<li><a href="#1-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E7%BA%BF%E7%A8%8B">1. ä»€ä¹ˆæ—¶å€™åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Ÿ</a></li>
<li><a href="#2-%E5%A6%82%E4%BD%95%E5%85%B3%E9%97%AD%E7%BA%BF%E7%A8%8B%E6%B1%A0">2. å¦‚ä½•å…³é—­çº¿ç¨‹æ± ï¼Ÿ</a></li>
</ul>
</li>
<li><a href="#%E4%BA%8C-%E6%8B%92%E7%BB%9D%E7%AD%96%E7%95%A5">äºŒã€æ‹’ç»ç­–ç•¥</a></li>
<li><a href="#%E4%B8%89-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E7%8A%B6%E6%80%81">ä¸‰ã€çº¿ç¨‹æ± çš„çŠ¶æ€</a></li>
<li><a href="#%E5%9B%9B-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%88%86%E7%B1%BB">å››ã€çº¿ç¨‹æ± åˆ†ç±»</a>
<ul>
<li><a href="#newcachedthreadpool">newCachedThreadPool</a></li>
<li><a href="#newfixedthreadpool">newFixedThreadPool</a></li>
<li><a href="#newsinglethreadexecutor">newSingleThreadExecutor</a></li>
<li><a href="#newscheduledthreadpool">newScheduledThreadPool</a></li>
<li><a href="#newworkstealingpool">newWorkStealingPool</a></li>
</ul>
</li>
<li><a href="#%E4%BA%94-%E4%BD%BF%E7%94%A8%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%9A%84%E5%A5%BD%E5%A4%84">äº”ã€ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="fullPage"><canvas id="canvas"></canvas></div>
</article>
<div id="eof"><span>EOF</span></div><div class="round-shape-one"></div>
<section>
<div class="doc_comments">

	  
		<div id="gitalk-container"></div>
		<!--è¯„è®ºæ˜¾ç¤ºåŒºï¼Œè¯·æ’å…¥åˆé€‚çš„ä½ç½®-->
<div id="comment"></div>
<!--Leancloud æ“ä½œåº“:-->
<script src="//cdn1.lncld.net/static/js/3.6.1/av-min.js"></script>
<!--Valine çš„æ ¸å¿ƒä»£ç åº“-->
<script src="//cdn.jsdelivr.net/npm/valine@1.4.4/dist/Valine.min.js"></script>
<script>
    new Valine({
        el:'#comment',
        appId: 'DysN4QrSvmmE6SpDXopbCLD6-gzGzoHsz',
        appKey: 'mjK643yLFa4WWXtobofr24Ap',
        placeholder: 'ãƒ¾ï¾‰â‰§âˆ€â‰¦)oå¿«æ¥è¯„è®ºä¸€ä¸‹å§!',
        avatar:''
    });
</script>
	  
		  
	  

</div></section>
</div></div></div>
<!--
<script>
"use strict";!function(){for(var n=document.getElementsByTagName("pre"),e=n.length,s=0;s<e;s++){n[s].innerHTML='<span class="line-number"></span>'+n[s].innerHTML+'<span class="cl"></span>';for(var a=n[s].innerHTML.split(/\n/).length,r=0;r<a-1;r++){n[s].getElementsByTagName("span")[0].innerHTML+="<span>"+(r+1)+"</span>"}}}();
let mainNavLinks=document.querySelectorAll(".markdownIt-TOC a");window.addEventListener("scroll",event=>{let fromTop=window.scrollY;mainNavLinks.forEach((link,index)=>{let section=document.getElementById(decodeURI(link.hash).substring(1));let nextSection=null
if(mainNavLinks[index+1]){nextSection=document.getElementById(decodeURI(mainNavLinks[index+1].hash).substring(1));}
if(section.offsetTop<=fromTop){if(nextSection){if(nextSection.offsetTop>fromTop){link.classList.add("currentToc");}else{link.classList.remove("currentToc");}}else{link.classList.add("currentToc");}}else{link.classList.remove("currentToc");}});});
var list=document.querySelectorAll(".katex");for(var i=0;i<list.length;i++){list[i].style.display="unset"};
var h=document.documentElement,b=document.body,st="scrollTop",sh="scrollHeight",progress=document.querySelector(".progress"),scroll;document.addEventListener("scroll",function(){scroll=(h[st]||b[st])/((h[sh]||b[sh])-h.clientHeight)*100;progress.style.setProperty("--scroll",scroll+"%")});
var wxScale=new WxScale({fullPage:document.querySelector("#fullPage"),canvas:document.querySelector("#canvas")});var imgBox=document.querySelectorAll("#md_block img");for(var i=0;i<imgBox.length;i++){imgBox[i].onclick=function(e){wxScale.start(this)}};
content="æœ¬æ–‡æœ€åæ›´æ–°äº2020-07-12ï¼Œå·²è¶…è¿‡ 1 å¹´æ²¡æœ‰æ›´æ–°ï¼Œæ¶‰åŠçš„å†…å®¹å¯èƒ½å·²ç»å¤±æ•ˆï¼";var date1="2020-07-12 18:36:31";date1=date1.replace("-","/");var date2=new Date();var date3=date2.getTime()-new Date(date1).getTime();var days=Math.floor(date3/(24*3600*1000));if(days>=365){document.getElementById("warn").innerHTML=content};
</script>
-->

<script>
    "use strict";
    ! function () {
        for (var n = document.getElementsByTagName("pre"), e = n.length, s = 0; s < e; s++) {
            n[s].innerHTML = '<span class="line-number"></span>' + n[s].innerHTML + '<span class="cl"></span>';
            for (var a = n[s].innerHTML.split(/\n/).length, r = 0; r < a - 1; r++) {
                n[s].getElementsByTagName("span")[0].innerHTML += "<span>" + (r + 1) + "</span>"
            }
        }
    }();
    let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");
    window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;
        mainNavLinks.forEach((link, index) => {
            let section = document.getElementById(decodeURI(link.hash).substring(1));
            let nextSection = null
            if (mainNavLinks[index + 1]) {
                nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(
                    1));
            }
            if (section.offsetTop <= fromTop) {
                if (nextSection) {
                    if (nextSection.offsetTop > fromTop) {
                        link.classList.add("currentToc");
                    } else {
                        link.classList.remove("currentToc");
                    }
                } else {
                    link.classList.add("currentToc");
                }
            } else {
                link.classList.remove("currentToc");
            }
        });
    });
    var list = document.querySelectorAll(".katex");
    for (var i = 0; i < list.length; i++) {
        list[i].style.display = "unset"
    };
    var h = document.documentElement,
        b = document.body,
        st = "scrollTop",
        sh = "scrollHeight",
        progress = document.querySelector(".progress"),
        scroll;
    document.addEventListener("scroll", function () {
        scroll = (h[st] || b[st]) / ((h[sh] || b[sh]) - h.clientHeight) * 100;
        progress.style.setProperty("--scroll", scroll + "%")
    });
    var wxScale = new WxScale({
        fullPage: document.querySelector("#fullPage"),
        canvas: document.querySelector("#canvas")
    });
    var imgBox = document.querySelectorAll("#md_block img");
    for (var i = 0; i < imgBox.length; i++) {
        imgBox[i].onclick = function (e) {
            wxScale.start(this)
        }
    };
    content = "æœ¬æ–‡æœ€åæ›´æ–°äº2020-07-12ï¼Œå·²è¶…è¿‡ 1 å¹´æ²¡æœ‰æ›´æ–°ï¼Œæ¶‰åŠçš„å†…å®¹å¯èƒ½å·²ç»å¤±æ•ˆï¼";
    var date1 = "2020-07-12 18:36:31";
    date1 = date1.replace("-", "/");
    var date2 = new Date();
    var date3 = date2.getTime() - new Date(date1).getTime();
    var days = Math.floor(date3 / (24 * 3600 * 1000));
    if (days >= 365) {
        document.getElementById("warn").innerHTML = content
    };
</script>

<style>#magnifyImg{position:fixed;left:0;top:0;text-align:center;width:100%;display:none;z-index:9999}#magnifyImg img{object-fit:contain;background:#eaecef;padding:15px;border-radius:10px;height:auto;width:auto;vertical-align:middle}</style>
<a id="scrollUp" href="#top" style="position: fixed; z-index: 2147483647; display: block;"></a><div class="footer animated fadeInDown"><div class="site_footer"><div class="mysocials"><div class="my_socials"></div></div><div class="copyright"id="copyright">Copyright Â© 2018-2020 <a href="https://xzzz2020.github.io" style="margin:0;">xzzz2020</a>.</div>
<span style="display: inline;margin-right:15px;">ğŸ‘<strong><span id="busuanzi_value_site_pv"></span></strong></span><span id="busuanzi_container_page_pv" style="display: inline;"><span>ğŸ“š<strong>58</strong> posts</span></div></div>
<script>
console.log("\n %c \u26a1Theme: Bitcron-pro Author's Blog:https://blog.blinkstar.cn  Writen By Serence  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;", );
</script>
<script src="https://cdn.jsdelivr.net/npm/instant.page@3.0.0/instantpage.min.js" type="module" defer></script>
<script type="text/javascript" async src="https://xzzz2020.github.io/media/js/prism.js"></script>
</body>
</html>